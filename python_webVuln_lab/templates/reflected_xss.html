<!DOCTYPE html>
<html>
<head>
    <title>Server-side Template Injecton</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/nes.css/css/nes.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='./style.css') }}">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <style>
        .samplecode {
        padding: 0px; /* Adjust the padding value as needed */
        display: hidden; /* Initially hidden */
        max-height: 450px; /* Set a maximum height as needed */
        text-align: left;
        font-size: 32px; /* Adjust the font size as needed */
        }
        .wrapper{
            display: flex;
            flex-direction: column;
        }
    </style>
</head>
<body>
    <div class="navbar">
        <header class="sticky">
            <div class="container">
                <div class="nav-brand">
                    <a href="http://localhost:8000/">
                        <h1><i class="snes-jp-logo brand-logo"></i>0xS3cUr1ty</h1></a> 
                        <p class="nes-text">Python Vulnerability Lab</p>
                    </div> 
                    <div class="lab-buttons"> 
                        <div class="share" style="width: 1000px;">
                            <section style="width: 200px;">
                                <button type="button" class="nes-btn is-success" onclick="document.getElementById('dialog-sqli').showModal();">
                                    SQL Injection
                                </button>
                                <dialog class="nes-dialog" id="dialog-sqli">
                                    <form method="dialog">
                                      <p class="title">Types of SQLi</p>
                                      <menu class="dialog-menu">
                                        <a href="/union_sqli" class="nes-btn" style="width: 100%;">UNION-based SQLi</a>
                                        <a href="/err_sqli" class="nes-btn is-primary" style="width: 100%;">Error-based SQLi</a>
                                        <a href="/bool_sqli" class="nes-btn is-success" style="width: 100%;">Boolean-based SQLi</a>
                                        <a href="/time_sqli" class="nes-btn is-warning" style="width: 100%;">Time-based SQLi</a>
                                        <button class="nes-btn is-error" style="width: 100%;">Cancel</button>
                                      </menu>
                                    </form>
                                </dialog>
                            </section>
                            <section style="width: 300px; margin-left: 12px;">
                                <button type="button" class="nes-btn is-warning" onclick="document.getElementById('dialog-xss').showModal();">
                                    Cross-site Scripting
                                </button>
                                <dialog class="nes-dialog" id="dialog-xss">
                                    <form method="dialog">
                                      <p class="title">Types of XSS</p>
                                      <menu class="dialog-menu">
                                        <a href="/reflected_xss" class="nes-btn" style="width: 100%;">Reflected XSS</a>
                                        <a href="/stored_xss" class="nes-btn is-primary" style="width: 100%;">Stored XSS</a>
                                        <a href="/dom_xss" class="nes-btn is-success" style="width: 100%;">DOM-based XSS</a>
                                        <button class="nes-btn is-error" style="width: 100%;">Cancel</button>
                                      </menu>
                                    </form>
                                </dialog>
                            </section>
                            <a class="nes-btn is-error" href="/ssti">Server-side Template Injecton</a>
                        </div>
                    </div>
                </div>
            </header>
    </div>
    <div class="wrapper">
        <section class="showcase">
            <section class="nes-container with-title">
                <h1 class="title">Chat - Reflected Cross-site Scripting</h1>
                <form method="get">
                    <div class="nes-field">
                        <label for="name_field">Your name:</label>
                        <input type="text" id="name" name="name" class="nes-input" style="width: 1000px;" required>
                    </div>
                    <button type="submit" class="nes-btn is-primary">Submit</button>
                </form>
                <button type="button" class="nes-btn is-primary showcode" onclick="toggleCodeSection()">&lt;&gt;</button>
            </section>
            {% if name %}
            <section class="nes-container" id="chat">
                <section class="message-list">
                    <section class="message -left">
                    <i class="nes-bcrikko"></i>
                    <!-- Balloon -->
                    <div class="nes-balloon from-left">
                        <p>Hello {{ name|safe }}!</p>
                    </div>
                </section>
            </section>
            {% endif %}
        </section>
        <section class="samplecode nes-container">
            <pre><code class="html hljs">
                {{ "<p>Hello {{ name|safe }}!</p>"|e }}
            </code></pre>
        </section>
    </div>
    <script>
        function changeMarginTop(newMarginTop) {
                    var samplecode = document.querySelector(".showcase");
                    if (samplecode) {
                        samplecode.style.marginTop = newMarginTop;
                }
            }
        hljs.highlightAll();
        /* Toggle code section */
        function toggleCodeSection() {
            var codeSection = document.querySelector(".samplecode");
            if (codeSection.style.display === "none" || codeSection.style.display === "") {
                codeSection.style.display = "block";
                changeMarginTop("4rem");
            } else {
                codeSection.style.display = "none";
                changeMarginTop("0rem");
            }
        }
    </script>
</body>
</html>
